{"version":3,"sources":["../src/socket.js"],"names":["net","require","PORT","HOST","BOTCODE","Client","constructor","port","address","hash","botCode","socket","Socket","intervalTimer","resend","destroied","sendData","dataSubscription","subject","Subject","prevJSONData","gameHash","init","client","connect","console","log","on","data","toString","clearInterval","reconnect","write","Buffer","from","setInterval","getData","BASE_JSON_URL","error","removeAllListeners","setTimeout","destroy","unsubscribe","prepareData","asObservable","subscribe","initPayload","JSON","parse","payload","add_tens_zero","force_ones","undefined","last_number","forEach","element","parseInt","guest_name","substring","padEnd","home_name","add_hundreds_zero","length","url","https","get","res","next","value","read"],"mappings":"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","sourcesContent":["\nimport { Subject } from 'rxjs'; \nimport * as https from 'https';\nimport { BASE_JSON_URL } from './config';\nconst net = require('net');\nconst PORT = 52275;\nconst HOST = '127.0.0.1';\nconst BOTCODE = '01743';\n// const HOST = 'host.docker.internal';\n\n\nexport default class Client {\n\n  constructor(port, address, hash, botCode) {\n    this.socket = new net.Socket();\n    this.address = address || HOST;\n    this.port = port || PORT;\n    this.intervalTimer = null;\n    this.resend = 0;\n    this.destroied = false;\n    this.sendData = null;\n    this.dataSubscription = null;\n    this.subject = new Subject();\n    this.prevJSONData = null;\n    this.gameHash = hash || null;\n    this.botCode = botCode || BOTCODE;\n  }\n\n  init () {\n    let client = this;\n    client.socket.connect(\n      client.port,\n      client.address, \n      () => {\n        console.log(`Client connected to: ${client.address} : ${client.port}`);        \n      }\n    );\n\n    client.socket.on('data', data => {\n      console.log(\"Received: \", data.toString());\n    });\n\n    client.socket.on('close', () => {\n      console.log(\"Connection closed!\");\n      if (client.intervalTimer != null)\n        clearInterval(client.intervalTimer);\n      client.reconnect();\n    });\n\n    client.socket.on('end', () => {\n      console.log(\"Connection ended!\");\n      if (client.intervalTimer != null)\n        clearInterval(client.intervalTimer);\n      client.reconnect();\n    })\n\n    client.socket.on('connect', () => {\n      client.socket.write(Buffer.from('BOT' + client.botCode, 'ascii'));\n      client.intervalTimer = setInterval(() => {\n        client.getData(`${BASE_JSON_URL}${client.gameHash}_game.json`);\n      }, 2000);\n    })\n\n    client.socket.on('error', error => {\n      console.log(\"Error ==== \", error);\n      if (client.intervalTimer != null)\n        clearInterval(client.intervalTimer);\n      // client.socket.removeAllListeners();\n    })\n  }\n\n  \n\n  reconnect () {\n    let client = this;\n    if (client.destroied == true) {\n      client.socket.removeAllListeners();\n      return;\n    }\n    setTimeout(() => {\n      client.socket.removeAllListeners() // the important line that enables you to reopen a connection\n      client.init();\n    }, 5000)\n  }\n\n  destroy() {\n    let client = this;\n    if (client.dataSubscription != null)\n      client.dataSubscription.unsubscribe();\n    client.destroied = true;\n    client.socket.destroy();\n    if (client.intervalTimer != null)\n        clearInterval(client.intervalTimer);\n  }\n\n  prepareData() {\n    let client = this; \n    client.dataSubscription = client.subject.asObservable().subscribe((data) => {\n      // console.log(\"Subscribed Data ==== \", JSON.parse(data));\n      let initPayload = JSON.parse(data);\n      let payload = '';\n      if (client.prevJSONData != initPayload) {\n        client.prevJSONData = initPayload;\n        /*Payload must be 150 bytes ending with \\n  (151 total)\n              (zero indexed)\n              Position\n              6   balls\n              7   strikes\n              8   Outs\n              9   Innings tens\n              10  Innings ones\n              11  Guest Runs tens\n              12  Guest Runs ones\n              13  Home Runs tens\n              14  Home Runs ones\n              15  Top/Bottom of Inning (T/B)\n              16  Guest Hits tens\n              17  Guest Hits ones\n              18  Home Hits tens\n              19  Home Hits ones\n              20  Guest Errors ones\n              21  Home Errors ones\n              22  Uni for Hitter tens\n              23  Uni for Hitter ones\n              24  Error Flag (H, E or blank)\n              25  Guest Error #\n              26  Top of Inning\n              27  Bottom of Inning\n              28-29 blank\n              30-49  Guest and Home Inning values from 1 - 10\n        */\n       \n        \n        if (initPayload['live_board']['top_of_inning']) {\n          payload = '010000' + \n          initPayload['live_board']['balls'] + \n          initPayload['live_board']['strikes'] +\n          initPayload['live_board']['outs'] + \n          client.add_tens_zero(initPayload['live_board']['inning']) + \n          client.add_tens_zero(initPayload['live_board']['away_score']) + \n          client.add_tens_zero(initPayload['live_board']['home_score']) + \n          'T' + \n          client.add_tens_zero(initPayload['live_board']['away_hits']) + \n          client.add_tens_zero(initPayload['live_board']['home_hits']) + \n          client.force_ones(initPayload['live_board']['away_errors']) + \n          client.force_ones(initPayload['live_board']['home_errors'])\n        } else {\n          payload = '010000' + \n          initPayload['live_board']['balls'] + \n          initPayload['live_board']['strikes'] +\n          initPayload['live_board']['outs'] + \n          client.add_tens_zero(initPayload['live_board']['inning']) + \n          client.add_tens_zero(initPayload['live_board']['away_score']) + \n          client.add_tens_zero(initPayload['live_board']['home_score']) + \n          'B' + \n          client.add_tens_zero(initPayload['live_board']['away_hits']) + \n          client.add_tens_zero(initPayload['live_board']['home_hits']) + \n          client.force_ones(initPayload['live_board']['away_errors']) + \n          client.force_ones(initPayload['live_board']['home_errors'])\n        }\n        \n        if (initPayload['sboard']['hitter'] != undefined && initPayload['sboard']['hitter']['uni'] != undefined) {\n          payload += client.add_tens_zero(initPayload['sboard']['hitter']['uni']);\n        } else {\n          payload += '  ';\n        }\n        \n        payload += ' '; // Error/Hit Flag\n        payload += '     '; // Add 5 blanks for 25-29\n        \n        let last_number = null;\n        initPayload['innings'].forEach(element => {\n          if (parseInt(element['number']) <= 10) {\n            last_number = parseInt(element['number']);\n            payload += client.force_ones(element['away_runs']) + client.force_ones(element['home_runs']);\n          }\n        });\n        if (last_number != null) {\n          while (parseInt(last_number) < 10) {\n            // Fill in the with blanks up to 10\n            last_number += 1;\n            payload += '  ';\n          }\n        }\n  \n        // 50-57 is Guest Name\n        var guest_name = initPayload['live_board']['away_name'].substring(0, 8);\n        guest_name = guest_name.padEnd(8, ' ');\n        payload += guest_name;\n  \n        // 58-65 is Home Name\n        var home_name = initPayload['live_board']['home_name'].substring(0, 8);\n        home_name = home_name.padEnd(8, ' ');\n        payload += home_name;\n  \n        //66 On First 67 On Second 68 On Thrid\n        if (initPayload['live_board']['on_first'])\n          payload += '1';\n        else \n          payload += ' ';\n        \n        if (initPayload['live_board']['on_second'])\n          payload += '1';\n        else \n          payload += ' ';\n  \n        if (initPayload['live_board']['on_third'])\n          payload += '1';\n        else \n          payload += ' ';\n  \n        //Pitch Speed 69, 70, 71\n        if (initPayload['sboard']['last_velo']) {\n          payload += client.add_hundreds_zero(initPayload['sboard']['last_velo']);\n        } else {\n          payload += 0;\n        }\n  \n        //Pitch Count \n        if (initPayload['sboard']['pitcher'] != undefined && initPayload['sboard']['pitcher']['stats'] != undefined) {\n          payload +=  client.add_hundreds_zero(initPayload['sboard']['pitcher']['stats']['pitches']);\n        } else {\n          payload += '   ';\n        }\n        payload = payload.padEnd(133, ' ');\n        // payload += '01743'; //Add BOT code\n        payload += client.botCode; // Add BOT code\n        payload += '8D2E6CB31B35';\n        payload += '\\n';\n\n        // payload = '010000000 3 2 0T 4 010 1      002000              LKN13   Big Test      15                                                           017438D2E6CB31B35\\n';\n        console.log(\"Payload Length === \", payload, payload.length);\n        client.sendData = Buffer.from(payload, 'ascii');\n        \n      }\n      \n        client.socket.write(client.sendData);\n    })\n  }\n\n  getData(url) {\n    let client = this;\n    https.get(url, (res) => {\n      res.on('data', (data) => {\n        client.subject.next(Buffer.from(data).toString());\n      });\n    }).on('error', (error) => {\n      console.log(error);\n    })\n  }\n  \n  add_tens_zero(value) {\n    if (parseInt(value) > 9)\n      return value.toString();\n    else\n      return ' ' + value;\n  }\n  \n  add_hundreds_zero(value) {\n    if (parseInt(value) >= 100)\n      return value.toString();\n    else if(parseInt(value) >= 10)\n      return ' ' + value;\n    else if (parseInt(value) > 0)\n      return '  ' + value;\n    else\n      return '   ';\n  }\n  \n  force_ones(value) {\n    if (value > 9)\n      return '9';\n    else \n      return value.toString();\n  }\n\n  read() {\n    this.prepareData();\n    this.init();\n  }\n}"],"file":"socket.js"}